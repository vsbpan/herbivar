---
title: Using *herbivar* to Fit Neutral Models
author: "Vincent Pan"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_document:
    toc_float: true
    toc: true 
    toc_depth: 2 
    number_sections: true 
    code_folding: show
---

```{r, include = FALSE}
knitr::opts_chunk$set(fig.align = "center")
```


# Prerequisets 

To follow this vignette and use the *herbivar* package, you'll need to first use the `install_github()` function from the *devtools* package to install the latest version of *herbivar* from github. You can just run the code chunk below on your machine to install the package. 

```{r}
if(suppressMessages(!require(herbivar))){
  if(!nzchar(system.file(package = "devtools"))){
    install.packages("devtools")
  }
  devtools::install_github("vsbpan/herbivar")
} else {
  message("Sweet! Herbivar is installed!")
}

```


# Introduction



# Neutral model

# Formulation

# Supporting functions

## Fitting the neutral model
```{r}
set.seed(12)
a<-fit_bite_size(rallo(100, max.phi = 0.4),min.phi = 0.005)
coef(a,se = TRUE)

```


# Generic null models
## Formulation

## Supporting functions

## Fitting the generic null models


# Model assessment 

```{r}

probe_distribution(ralloT(1000, lambda = 3), 
                   probes = c("mean", "var", "Skew","median"))

```


```{r}
allo_probed <- lapply(seq_len(100), function(i){
  x <- ralloT(1000, lambda = 3, max.phi = 1)
  probe_distribution(x)
}) %>%
  do.call("rbind",.)

allo_probed2 <- lapply(seq_len(100), function(i){
  x <- ralloT(1000, lambda = 3, max.phi = 0.5)
  probe_distribution(x)
}) %>%
  do.call("rbind",.)


probed.data <- rbind(
  data.frame("distribution" = "max.phi = 1", allo_probed),
  data.frame("distribution" = "max.phi = 0.5", allo_probed2)
)

vegan::rda(probed.data[,-1]) %>%
  get_biplot(choices = c(1,2), 
             group = probed.data$distribution) + 
  ggplot2::theme_bw(base_size = 15) + 
  ggplot2::labs(color = "Distribution")


vegan::rda(probed.data[,-1] ~ probed.data$distribution)
```



# Other handy functions


# Session Info

```{r}
sessionInfo()
```

















